import pandas as pd
import matplotlib.pyplot as plt

# Load the Excel file
file_path = 'D:/SIT University/Y1T3/Data Structure and Algorithm/Project/FINAL_DATASET.xlsx'  
sheet_name = 'Sheet1'  

# Read the Excel file into a DataFrame
df = pd.read_excel(file_path, sheet_name=sheet_name)

# Ensure 'Exploitability Score' and 'Impact Score' are numeric
df['Exploitability Score'] = pd.to_numeric(df['Exploitability Score'], errors='coerce')
df['Impact Score'] = pd.to_numeric(df['Impact Score'], errors='coerce')

# Drop rows with missing values in either 'Exploitability Score' or 'Impact Score'
df.dropna(subset=['Exploitability Score', 'Impact Score'], inplace=True)

# Plotting the hexbin plot with a qualitative colormap for better visibility
plt.figure(figsize=(12, 10))
plt.hexbin(df['Exploitability Score'], df['Impact Score'], gridsize=100, cmap='Set1', mincnt=10, linewidths=1.5)
plt.colorbar(label='Legend for Overlapping Points')
plt.title('Hexbin Plot of Exploitability Score vs Impact Score')
plt.xlabel('Exploitability Score')
plt.ylabel('Impact Score')
plt.grid(True)
plt.tight_layout()

# Display the hexbin plot
plt.show()
